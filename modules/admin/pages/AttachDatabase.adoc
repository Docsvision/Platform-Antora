[[ariaid-title1]]
== Подключение к серверу Docsvision существующей базы данных

[NOTE]
====
[.note__title]#Важное замечание:# Не изменяйте конфигурацию сателлитных БД при подключении существующей БД Docsvision 5.5!
====

[[task_iwn_jfm_fp__steps_cgn_4fm_fp]]
. [.ph .cmd]#Откройте xref:DatabasesMaster.adoc[мастер БД Docsvision].#
+
image::img/DatabaseMaster.png[[.fig--title-label]##Рис. 1. ##Мастер БД Docsvision]
. [.ph .cmd]#Выберите режим «Подключить существующую базу данных, не представленную в списке». Нажмите [.ph .uicontrol]*Далее*.#
. [.ph .cmd]#Укажите данные для подключения к СУБД. Нажмите [.ph .uicontrol]*Далее*.#
+
image::img/DatabaseAttach_1.png[[.fig--title-label]##Рис. 2. ##Мастер БД Docsvision в режиме подключения базы данных]
+
* [.ph .uicontrol]*Тип сервера* – тип используемой СУБД:
+
** Microsoft SQL Server;
** PostgreSQL.
* [.ph .uicontrol]*Имя сервера* – сетевое имя сервера/экземпляра СУБД (например: «sql.company.com»). Для БД PostgreSQL имя сервера следует указывать без домена (например, «postgre», а не «postgre.company.com») – не следует использовать IP и имя LOCALHOST;
* [.ph .uicontrol]*Порт* (только для PostgreSQL) – порт подключения к СУБД (в PostgreSQL по умолчанию используется порт 5432);
* [.ph .uicontrol]*Проверка подлинности* – тип проверки подлинности, используемой для подключения к СУБД:
** SQL Server – аутентификация с помощью учетной записи, зарегистрированной в СУБД;
** Windows – аутентификация с помощью текущей учетной записи Windows.
+
[NOTE]
====
[.note__title]#Прим.:# См. xref:WindowsAccountSingularity.adoc[Особенности использования SQL-аутентификация и аутентификация Windows при подключении к БД Docsvision].
====
* [.ph .uicontrol]*Логин*, [.ph .uicontrol]*Пароль* – данные учетной записи для подключения к СУБД.
. [.ph .cmd]#Укажите параметры подключения БД и нажмите [.ph .uicontrol]*Далее*.#
+
image::img/DatabaseAttach_2.png[[.fig--title-label]##Рис. 3. ##Мастер БД Docsvision в режиме подключения базы данных]
[loweralpha]
.. [.ph .cmd]#Укажите основные параметры БД:#
+
* [.ph .uicontrol]*Имя* – название подключаемой БД;
* [.ph .uicontrol]*Псевдоним* – псевдоним БД, с которым она будет зарегистрирована в Docsvision; обычно совпадает с именем БД. *Псевдоним должен быть уникальным* в пределах данного сервера Docsvision;
.. [.ph .cmd]#Нажмите кнопку [.ph .uicontrol]*Настройки*, если требуется изменить конфигурацию xref:DBExternalTables.adoc[сателлитных баз данных] (только при подключении БД Docsvision версии 5.4) и использования отдельных xref:DBTempTables.adoc[служебных таблиц].#
+
При подключении БД Docsvision 5.5 сохраняется существующая (в данной БД) конфигурация сателлитных БД и служебных таблиц.
+
[NOTE]
====
[.note__title]#Важное замечание:# Не рекомендуется изменять конфигурацию сателлитных БД (включать/отключать использование), если подключается БД Docsvision версии 5.5, т.к. при этом часть данных станет недоступна – данные между хранилищами не переносятся (из основной в сателлитную БД или из сателлитной в основную).
====
. [.ph .cmd]#На следующей странице мастера нужно выбрать обновляемые библиотеки карточек модулей. По умолчанию будут выбраны все библиотеки, требующие обновления. Если необходимо, измените выбор. Нажмите [.ph .uicontrol]*Далее* для продолжения.#
+
image::img/updateDbOnAttach.png[[.fig--title-label]##Рис. 4. ##Выбор модулей для обновления]
. [.ph .cmd]#Подтвердите параметры подключения базы данных.#
+
image::img/DatabaseAttach_3.png[[.fig--title-label]##Рис. 5. ##Подтверждение параметров подключения БД]
+
Значение [.ph .uicontrol]*Ожидать завершения атомарной операции на SQL Server (сек)* определяет максимальное время ожидания завершения отдельного этапа (операции) процедуры создания/подключения БД. Если операция не будет выполнена за указанное время, она завершится с ошибкой.

[NOTE]
====
[.note__title]#Прим.:# Параметр [.ph .uicontrol]*Ожидать завершения атомарной операции на SQL Server (сек)* не ограничивает время выполнения пользовательских операций (при работе в Windows-клиенте) – будет применяться стандартное ограничение 600 секунд.
====
+
Если выбранная база данных подключена (или была подключена ранее) к другому серверу Docsvision, и лицензия Docsvision не позволяет работать с одной БД одновременно нескольким серверам Docsvision, то при нажатии кнопки [.ph .uicontrol]*Далее* на экран будет выведено окно для выбора варианта отключения БД.

image::img/Database_Wizard_Parallel_Servers.png[[.fig--title-label]##Рис. 6. ##Диалоговое окно "Внимание: параллельные серверы"]

Нажмите на кнопку [.ph .uicontrol]*Продолжить*, чтобы система автоматически отключила БД от других серверов Docsvision.

Данная процедура подразумевает, что БД будет перемещена (переключена) с одного сервера Docsvision на другой. Дополнительная информация приведена в разделе xref:DatabaseMoving.adoc[Перенос БД Docsvision между серверами Docsvision].

Следующие шаги 7-10 выполняются только, если требуется обновление БД.

[start=7]
. [.ph .cmd]#Дождитесь завершения загрузки SQL объектов.#

Следующие шаги выполняются только при подключении БД из «Консоли администрирования Docsvision». При первоначальной настройке Docsvision загрузка дополнительных модулей выполняется [.dfn .term]_Мастером настройки Docsvision_.

[start=8]
. [.ph .cmd]#Выберите модули Docsvision, настройки которых должны быть загружены в БД.#
+
image::img/DatabaseCreate_5.png[[.fig--title-label]##Рис. 7. ##Выбор модулей, настройки которых будут загружены в БД]
+
Существующие в БД настройки загружаемых модулей будут перезаписаны.
. [.ph .cmd]#Дождитесь завершения загрузки настроек.#
. [.ph .cmd]#Согласитесь с перезапуском сервисов Docsvision для применения новых параметров.#
+
image::img/ConfigMaster_7.png[[.fig--title-label]##Рис. 8. ##Запрос на перезапуск сервисов Docsvision]
. [.ph .cmd]#Предоставьте сервисам Docsvision xref:GrantAccessServices.adoc[необходимые права] (в т.ч. права на новую БД).#

*На уровень выше:* xref:../topics/Database.adoc[Управление базами данных]
