= Пример. Настройка хранилища файлов в файловой системе

Далее приведен пример настройки хранилища файлов {dv} в файловой системе сервера {dv}.

. Откройте страницу настроек "Внешние хранилища":#
[loweralpha]
.. Откройте _{cns}_.
.. Перейдите в раздел настроек *Настройки сервера* > *Базы данных*#.
.. Выберите настраиваемую базу данных и нажмите на кнопку *Настройки*. Будет открыто окно *Свойства и управление базой данных*.
.. Откройте вкладку *Внешние хранилища*.
. Подключите к {dv} хранилище в файловой системе, следуя xref:SetupStorage.adoc[инструкции]. Параметры подключения настройте следующим образом:#
[loweralpha]
.. В поле `Название` введите "StorageInFileSystem" или любое другое название.
.. В списке `Тип` выберите значение "Хранилище на диске".
.. В списке `Состояние` выберите значение "Online".
.. В поле `Макс. размер` оставьте значение по умолчанию (0).
+
После того, как хранилище физически закончится, попытка добавления файла в него завершится ошибкой. Чтобы избежать этого, ограничьте размер хранилища:

[lowerroman]
... В поле `Макс. размер` укажите примерный объем свободного места на диске, которое может быть использовано для хранения файлов.
... В списке `Состояние` выберите значение "Auto".
.. Флаги в блоке `Разделы` установите по собственному усмотрению.
.. В поле `Путь` введите полный путь к каталогу для хранения бинарных данных файлов на сервере {dv}.
+
image::StorageFileSystemConfiguration.png[Пример настройки хранилища на файловой системе]
. Создайте группу хранилищ следуя xref:SetupStorageGroup.adoc[инструкции]. Параметры группы настройте следующим образом:#
[loweralpha]
.. В поле `Название` введите "FileSystemGroup" или любое другое название.
.. В списке `Режим выбора` оставьте значение по умолчанию.
+
image::StorageFileSystemGroup.png[Пример настройки группы хранилищ]

Хранилище можно включить в существующую группу, тогда создавать новую не требуется.
. Включите хранилище "StorageInFileSystem" в группу "FileSystemGroup" следуя xref:AddStorageToStoragesGroup.adoc[инструкции].
. Настройте правила помещения файлов в группу хранилищ "FileSystemGroup" следуя xref:SetupStorageRule.adoc[инструкции]. Параметры правила настройте следующим образом:#
[loweralpha]
.. В поле `Название` введите "RuleForFileSystemStorage" или любое другое название.
.. В списке `Группа` выберите значение "FileSystemGroup".
.. В списке `Тип` оставьте значение "Все файлы" или конкретизируйте параметры файлов (см. рисунок ниже), которые будут размещаться в хранилище.
+
image::RuleForStorageInFileSystem.png[Пример настройки правила для группы хранилищ "FileSystemGroup"]
. Повысьте приоритет использования правила "RuleForFileSystemStorage".
[loweralpha]
.. Выберите правило "RuleForFileSystemStorage" в списке правил.
.. Нажимайте на кнопку .image:buttons/ArrowUp.png[image] пока правило "RuleForFileSystemStorage" не поднимется в верх списка.
+
image::StorageInFileSystem.png[Пример настройки хранилища файлов в файловой системе]

При закрытии настроек БД согласитесь с перезапуском сервисов. Новая конфигурация файловых хранилищ применяется в течение 10 минут (по умолчанию).
