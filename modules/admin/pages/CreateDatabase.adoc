[[ariaid-title1]]
== Создание новой базы данных Docsvision

. [.ph .cmd]#Откройте xref:DatabasesMaster.adoc[мастер БД Docsvision].#
+
image::img/DatabaseMaster.png[[.fig--title-label]##Figure 1. ##Мастер БД Docsvision]
. [.ph .cmd]#Выберите режим «Создать новую базу данных и подключить ее к серверу». Нажмите [.ph .uicontrol]*Далее*.#
. [.ph .cmd]#Укажите информацию для создания БД. Нажмите [.ph .uicontrol]*Далее*.#
+
image::img/DatabaseCreate_1.png[[.fig--title-label]##Figure 2. ##Настройка подключения к СУБД]
+
[[task_dmg_5rf_l2b__AttachDb]]
* [.ph .uicontrol]*Тип сервера* – тип используемой СУБД:
+
** Microsoft SQL Server;
** PostgreSQL.
* [.ph .uicontrol]*Имя сервера* – сетевое имя сервера/экземпляра СУБД (например: «sql.company.com»). Для БД PostgreSQL имя сервера следует указывать без домена (например, «postgre», а не «postgre.company.com») – не следует использовать IP и имя LOCALHOST;
* [.ph .uicontrol]*Порт* (только для PostgreSQL) – порт подключения к СУБД (в PostgreSQL по умолчанию используется порт 5432);
* [.ph .uicontrol]*Проверка подлинности* – тип проверки подлинности, используемой для подключения к СУБД:
** SQL Server – аутентификация с помощью учетной записи, зарегистрированной в СУБД;
** Windows – аутентификация с помощью текущей учетной записи Windows.
+
[NOTE]
====
[.note__title]#Note:# См. xref:WindowsAccountSingularity.adoc[Особенности использования SQL-аутентификация и аутентификация Windows при подключении к БД Docsvision].
====
* [.ph .uicontrol]*Логин*, [.ph .uicontrol]*Пароль* – данные учетной записи для подключения к СУБД.
. [.ph .cmd]#Укажите параметры создания БД и нажмите [.ph .uicontrol]*Далее*.#
+
image::img/DatabaseCreate_2.png[[.fig--title-label]##Figure 3. ##Настройка создания БД в Microsoft SQL Server]
[loweralpha]
.. [.ph .cmd]#Укажите основные параметры БД:#
+
* [.ph .uicontrol]*Имя* – название БД, с которым она будет создана в СУБД;
* [.ph .uicontrol]*Псевдоним* – псевдоним БД, с которым она будет зарегистрирована в Docsvision; обычно совпадает с именем БД;
+
[NOTE]
====
[.note__title]#Important:# Псевдоним должен быть уникальным в пределах данного сервера Docsvision.
====
* [.ph .uicontrol]*Размещение* (только для MS SQL) – определяет расположение файлов БД на сервере СУБД:
** Стандартное – расположение файлов определяется настройками СУБД;
** Другое – расположение файлов БД указывается администратором; данный вариант размещения применим, если серверная часть модуля «Платформа» и СУБД установлены на одном компьютере;
* [.ph .uicontrol]*Язык* (только для MS SQL) – язык создаваемой БД. Следует выбирать локаль, которая установлена в параметре [.keyword .parmname]_Server Collation_ (способ сортировки данных в таблицах) экземпляра Microsoft SQL Server. Рекомендуемое значение: «Cyrillic_General_CI_AS» (Русский).
.. [.ph .cmd]#*Только для БД Microsoft SQL Server*. Если требуется, включите создание сателлитных баз данных. Для этого нажмите кнопку [.ph .uicontrol]*Настройки* и выберите данные, которые должны храниться в отдельных базах данных. Подробности в пункте xref:DBExternalTables.adoc[Подключение сателлитных баз данных].#
+
По умолчанию использование сателлитных БД отключено.
. [.ph .cmd]#Если требуется, выберите собственный SQL-скрипт, используемый для создания базы данных. Нажмите [.ph .uicontrol]*Далее*.#
+
image::img/DatabaseCreate_3.png[[.fig--title-label]##Figure 4. ##Выбор SQL-скрипта для создания базы данных]
+
* [.ph .uicontrol]*Стандартный* – использовать стандартные скрипты Docsvision для создания БД;
* [.ph .uicontrol]*Другой* – использовать собственный скрипт для создания БД.
. [.ph .cmd]#Выберите библиотеки карточек для загрузки в новую БД. По умолчанию будут выбраны все библиотеки, которые можно загрузить. Нажмите [.ph .uicontrol]*Далее*.#
+
image::img/LibrariesToLoadInNewDB.png[[.fig--title-label]##Figure 5. ##Выбор модулей для загрузки]
+
Выбор библиотеки для загрузки осуществляется установкой флажка в строке соответствующей библиотеки. Рекомендуется выбрать все доступные библиотеки карточек.

[NOTE]
====
[.note__title]#Note:# Для работы с соответствующим модулем и зависимыми от него модулями, должна быть загружена его библиотека карточек.
====
. [.ph .cmd]#Подтвердите параметры, которые будут использованы при создании базы данных. Нажмите [.ph .uicontrol]*Далее*.#
+
image::img/DatabaseCreate_4.png[[.fig--title-label]##Figure 6. ##Подтверждение параметров создания БД]
+
[[task_dmg_5rf_l2b__SetTimeout]]
Значение [.ph .uicontrol]*Ожидать завершения атомарной операции на SQL Server (сек)* определяет максимальное время ожидания завершения отдельного этапа (операции) процедуры создания/подключения БД. Если операция не будет выполнена за указанное время, она завершится с ошибкой.

[NOTE]
====
[.note__title]#Note:# Параметр [.ph .uicontrol]*Ожидать завершения атомарной операции на SQL Server (сек)* не ограничивает время выполнения пользовательских операций (при работе в Windows-клиенте) – будет применяться стандартное ограничение 600 секунд.
====
. [.ph .cmd]#Дождитесь завершения инициализации БД и загрузки SQL объектов.#

Следующие шаги выполняются только при создании новой БД из «Консоли администрирования Docsvision». При первоначальной настройке Docsvision загрузка дополнительных модулей выполняется [.dfn .term]_Мастером настройки Docsvision_.

[start=9]
. [.ph .cmd]#Выберите модули Docsvision, данные которых должны быть загружены в БД. Нажмите [.ph .uicontrol]*Завершить*.#
+
image::img/DatabaseCreate_5.png[[.fig--title-label]##Figure 7. ##Выбор модулей, настройки которых будут загружены в БД]
+
Если настройки модуля Docsvision не загружены в БД, работа с данным модулем будет невозможна. Если библиотеки карточек выбранных модулей не были загружены в БД, они будут загружены принудительно.
. [.ph .cmd]#Согласитесь с перезапуском сервисов Docsvision для применения новых параметров.#
+
image::img/ConfigMaster_7.png[[.fig--title-label]##Figure 8. ##Запрос на перезапуск сервисов Docsvision]
. [.ph .cmd]#Чтобы назначить созданную БД основной, следуйте инструкции xref:ChoiceDefaultDatabase.adoc[Назначение базы данных по умолчанию].#
+
Основная БД – база данных, с которой работают пользователи, если при подключении к серверу не выбрана иная БД. Сервисы Docsvision также работают с основной БД.
. [.ph .cmd]#Предоставьте сервисам Docsvision указанные в пункте xref:GrantAccessServices.adoc[Настройка учетных записей сервисов Docsvision] права.#

*Parent topic:* xref:../topics/Database.adoc[Управление базами данных]
